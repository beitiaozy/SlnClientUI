<navbar parameter="{{ parameter }}"></navbar>
<view class="tab-content-item">
  <!-- å·²ç™»å½• -->
  <view wx:if="{{isLogin}}" class="goods-detail-box">
    <view class="search-bar">
      <!-- åœºåœ°é€‰æ‹©å™¨åœ¨å·¦ -->
      <picker
              class="address-picker"
              mode="selector"
              range="{{addressList}}"
              range-key="name"
              value="{{addressIndex}}"
              bindchange="onAddressChange"
              bindtap="onAddressTap"
      >
        <view class="picker">
          <text>{{currentAddress ? currentAddress.short_name : 'é€‰æ‹©åœºåœ°'}}</text>
        </view>
        <!-- tooltip -->
        <text class="full-name-tip" wx:if="{{showFullName && currentAddress}}">
          {{currentAddress.name}}
        </text>
      </picker>

      <!-- æœç´¢æ¡†åœ¨å³ -->
      <input
              class="search-input"
              placeholder="è¯·è¾“å…¥æ‰‹æœºå·"
              value="{{ searchMobile }}"
              bindinput="onSearchInput"
      />
      <button
              type="primary"
              size="mini"
              bindtap="resetList"
              class="search-btn"
              disabled="{{!currentAddress}}"
      >
        æœç´¢
      </button>
    </view>

    <view class="container">
      <view class="copy-tip">
        <text class="iconfont icon-tishi"></text>
        <text>ç‚¹å‡»å¡ç‰‡ å¯å¤åˆ¶æ‰‹æœºå·ä¸è®¢å•å·</text>
      </view>

      <block wx:if="{{orderList.length > 0}}">
        <view class="card-list">
          <view
                  class="card"
                  bindtap="copyOrder"
                  wx:for="{{orderList}}"
                  wx:key="this"
                  data-id="{{item.order_id}}"
                  data-item="{{item}}"
          >
            <view class="card-header">
              <view class="card-title">
                <text class="order-icon">ğŸ“¦</text>
                <view class="title-info">
                  <text class="shop-name">{{item.site_name || 'æœªçŸ¥è®¾å¤‡'}}</text>
                  <text class="order-no">è®¢å•å·ï¼š{{item.pay_code || 'æš‚æ— '}}</text>
                </view>
              </view>
              <text class="status-tag {{item._statusType}}">{{item.status}}</text>
            </view>

            <view class="info-section">
              <view class="info-row">
                <text class="label">ç”¨æˆ·å</text>
                <text class="value">{{item.nickname}}</text>
              </view>
              <view class="info-row">
                <text class="label">æ‰‹æœºå·</text>
                <text class="value highlight">{{item.mobile}}</text>
              </view>
              <view class="info-row">
                <text class="label">IMEI</text>
                <text class="value">{{item.only_code}}</text>
              </view>
              <view class="info-row">
                <text class="label">å¼€å§‹æ—¶é—´</text>
                <text class="value">{{item.begin_time}}</text>
              </view>
              <view class="info-row" wx:if="{{item.status == 'å·²å®Œæˆ'}}">
                <text class="label">æ”¯ä»˜æ—¶é—´</text>
                <text class="value">{{item.end_time}}</text>
              </view>
            </view>

            <view class="amount-section" wx:if="{{item.status == 'å·²å®Œæˆ'}}">
              <view class="amount-row">
                <text class="label">å®é™…æ”¯ä»˜</text>
                <text class="value pay">ï¿¥{{item.net_amount}}</text>
              </view>
              <block wx:if="{{item.total_amount != item.net_amount}}">
                <view class="amount-row">
                  <text class="label">æ¶ˆè´¹é‡‘é¢</text>
                  <text class="value">ï¿¥{{item.total_amount}}</text>
                </view>
                <view class="amount-row">
                  <text class="label">æŠµæ‰£é‡‘é¢</text>
                  <text class="value discount">-ï¿¥{{item.discount_amount}}</text>
                </view>
              </block>
            </view>

            <view class="order-actions" wx:if="{{item.status == 'ä½¿ç”¨ä¸­'}}">
              <button class="cancel-btn" catchtap="cancelOrder" data-item="{{item}}">ç»“æŸè®¢å•</button>
            </view>
          </view>
        </view>

        <view wx:if="{{ no_more }}" class="no-more">äº², æ²¡æœ‰æ›´å¤šäº†</view>
      </block>

      <view wx:else class="empty">
        <image src="/images/empty-record.png" class="empty-icon" />
        <text class="empty-text">æš‚æ— è®¢å•è®°å½•</text>
        <text class="empty-subtext">å»ä¸‹ç¬¬ä¸€ç¬”è®¢å•å§</text>
      </view>
    </view>
  </view>

  <!-- æœªç™»å½• -->
  <view wx:else class="login-tip">
    è¯·å…ˆç™»å½•
  </view>
</view>
