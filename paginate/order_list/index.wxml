<navbar parameter="{{ parameter }}"></navbar>
<view class="container">
    <block wx:if="{{isLogin}}">
        <view class="copy-tip">
            <text class="iconfont icon-tishi"></text>
            <text>é»æ“Šå¡ç‰‡ å¯è¤‡è£½æ‰‹æ©Ÿè™Ÿèˆ‡è¨‚å–®è™Ÿ</text>
        </view>

        <block wx:if="{{orderList.length > 0}}">
            <view class="card-list">
                <view
                        class="card"
                        bindtap="copyOrder"
                        wx:for="{{orderList}}"
                        wx:key="this"
                        data-id="{{item.order_id}}"
                        data-item="{{item}}"
                >
                    <view class="card-header">
                        <view class="card-title">
                            <text class="order-icon">ğŸ“¦</text>
                            <view class="title-info">
                                <text class="shop-name">{{item.site_name || 'æœªçŸ¥è¨­å‚™'}}</text>
                                <text class="order-no">è¨‚å–®è™Ÿï¼š{{item.pay_code || 'æš«ç„¡'}}</text>
                            </view>
                        </view>
                        <text class="status-tag {{item._statusType}}">{{item.status}}</text>
                    </view>

                    <view class="info-section">
                        <view class="info-row">
                            <text class="label">ç”¨æˆ¶å</text>
                            <text class="value">{{item.nickname}}</text>
                        </view>
                        <view class="info-row">
                            <text class="label">æ‰‹æ©Ÿè™Ÿ</text>
                            <text class="value highlight">{{item.mobile}}</text>
                        </view>
                        <view class="info-row">
                            <text class="label">IMEI</text>
                            <text class="value">{{item.only_code}}</text>
                        </view>
                        <view class="info-row">
                            <text class="label">é–‹å§‹æ™‚é–“</text>
                            <text class="value">{{item.begin_time}}</text>
                        </view>
                        <view class="info-row" wx:if="{{item.status == 'å·²å®Œæˆ'}}">
                            <text class="label">æ”¯ä»˜æ™‚é–“</text>
                            <text class="value">{{item.end_time}}</text>
                        </view>
                    </view>

                    <view class="amount-section" wx:if="{{item.status == 'å·²å®Œæˆ'}}">
                        <view class="amount-row">
                            <text class="label">å¯¦éš›æ”¯ä»˜</text>
                            <text class="value pay">ï¿¥{{item.net_amount}}</text>
                        </view>
                        <block wx:if="{{item.total_amount != item.net_amount}}">
                            <view class="amount-row">
                                <text class="label">æ¶ˆè²»é‡‘é¡</text>
                                <text class="value">ï¿¥{{item.total_amount}}</text>
                            </view>
                            <view class="amount-row">
                                <text class="label">æŠµæ‰£é‡‘é¡</text>
                                <text class="value discount">-ï¿¥{{item.discount_amount}}</text>
                            </view>
                        </block>
                    </view>

                    <view class="order-actions" wx:if="{{item.status == 'ä½¿ç”¨ä¸­'}}">
                        <button class="cancel-btn" catchtap="cancelOrder" data-item="{{item}}">çµæŸè¨‚å–®</button>
                    </view>
                </view>
            </view>

            <view wx:if="{{ no_more }}" class="no-more">è¦ª, æ²’æœ‰æ›´å¤šäº†</view>
        </block>

        <view wx:else class="empty">
            <image src="/images/empty-record.png" class="empty-icon" />
            <text class="empty-text">æš«ç„¡è¨‚å–®è¨˜éŒ„</text>
            <text class="empty-subtext">å»ä¸‹ç¬¬ä¸€ç­†è¨‚å–®å§</text>
        </view>
    </block>

    <view wx:else class="login-tip"></view>
</view>
<authorize bind:onLoadFun="onLoadFun"></authorize>
